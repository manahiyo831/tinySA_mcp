# tinySA Ultraを使った測定の総合ガイド

## 1. デバイスの基本特性

### 技術仕様と特徴
- **デバイス識別**: ファームウェアバージョンはGitコミットハッシュ形式（例：tinySA4_v1.4-89-gfff9bed）
- **測定能力**: 最大450ポイントの測定分解能、RBW設定範囲は0.2kHz～850kHz
- **応答速度**: コマンド実行とレスポンスはほぼリアルタイム
- **画面表示**: 左側に設定パラメータが常時表示され、グリッド表示で信号把握が容易

### コマンドインターフェース特性
- **応答パターン**: コマンド実行後はエコーバック→結果→「ch>」プロンプトの順
- **構文規則**: 複合コマンドは非対応、個別コマンドとして実行する必要あり
- **単位表記**: 「92.5M」などの単位付き表記が便利（k、M、G対応）
- **引数なし実行**: 現在設定または使用法が表示される

## 2. 効率的な測定手順

### 準備と初期設定
1. **セッション開始**:
   ```
   reset                 # 初期状態にリセット
   mode low input        # FM帯に適した低周波モードに設定
   ```

2. **基本設定の構成**:
   ```
   sweep start 76M       # 開始周波数設定
   sweep stop 108M       # 終了周波数設定
   rbw 100               # 分解能帯域幅を100kHzに設定
   ```

### 段階的測定アプローチ
1. **全体像把握**:
   - 広範囲スキャン（例：76-108MHz）で信号分布を確認
   - `calc maxh`で最大値ホールド機能を有効化し、間欠的信号も捕捉

2. **詳細分析**:
   ```
   sweep center 92.4M    # 対象信号に中心を設定
   sweep span 2M         # 狭いスパンで詳細表示
   marker 1 peak         # 最強信号にマーカー配置
   ```

3. **複数信号の比較**:
   ```
   marker 2 on           # 2番目のマーカーを有効化
   marker 2 81.5M        # 特定周波数にマーカー2を配置
   ```

## 3. 測定精度向上テクニック

### パラメータ最適化
1. **RBW設定の使い分け**:
   - 広域スキャン：100kHz（高速）
   - 詳細観察：30kHz（精度向上）
   - 超精密測定：10kHz以下（時間要）

2. **トレースモード選択**:
   - `calc off` - 通常モード
   - `calc maxh` - 最大値ホールド（変動信号向け）
   - `calc aver4` - 平均化（ノイズ低減）

3. **マーカー機能活用**:
   - マーカーは自動配置と手動配置を使い分け
   - 自動配置後に手動微調整が最も効率的
   - マーカー応答は「マーカー番号 インデックス 周波数(Hz) レベル(dBm)」形式

### 測定結果の解釈
1. **周波数読み取り**:
   - tinySAは詳細表示（92.454MHz）だが標準チャンネルへの換算が必要
   - FMラジオは通常100kHzステップ（92.4MHz）に丸める

2. **信号強度評価**:
   - 同一信号でも測定ごとにわずかな変動があるのは正常
   - 伝搬環境変化やFM変調による自然現象

3. **視覚的確認の重要性**:
   - 設定変更後は必ず画像キャプチャで確認
   - マーカー位置の正確性を常に検証

## 4. 応用測定技術

### FM放送局測定最適手順
1. **広域スキャン設定**:
   ```
   mode low input
   sweep start 76M
   sweep stop 108M
   rbw 100
   calc maxh
   ```

2. **強信号詳細分析**:
   ```
   sweep center [強信号周波数]
   sweep span 2M
   marker 1 peak
   capture_image
   ```

3. **放送局識別**:
   - 測定周波数を最寄りの100kHzステップに丸める
   - 信号レベルとパターンから放送局タイプを推定

### 効率的なコマンドセット
```
# 基本測定セットアップ
reset
mode low input
sweep start 76M
sweep stop 108M
rbw 100
calc maxh

# 詳細分析
sweep center 92.4M
sweep span 2M
marker 1 peak

# 複数信号比較
marker 2 on
marker 2 81.5M
marker 3 on
marker 3 83.1M

# 分析終了・リセット
calc off
```

## 5. 問題解決とヒント

### よくある課題と対策
- **信号が見つからない**: RBWを広げるか、`calc maxh`で弱信号を捉える
- **不正確なピーク検出**: 狭いスパンと適切なRBWで再測定
- **スキャン速度が遅い**: RBWを広げるか、ポイント数を減らす
- **マーカーが意図した位置にない**: 手動で周波数指定

### 測定精度向上のポイント
- 測定前に必ずリセットし、予期せぬ設定を排除
- 適切なRBW選択が測定精度と速度のカギ
- 画像キャプチャを活用した視覚的確認の習慣化
- FMラジオ測定には100kHz RBWが最適バランス

